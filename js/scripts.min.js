!function(){"use strict";var e,t,s,n,r,o,i,a,c,l,h,m;i=chrome.storage.local,document.querySelector("#container"),l=document.querySelector(".close"),h=document.getElementById("change-source"),a=chrome.extension.getURL("settings.html"),c=document.querySelector(".settings-link").href=a,m=new Array,e=function(e){var t=[{cnn:"CNN"},{wapo:"Washington Post"},{npr:"NPR"},{deadspin:"Deadspin"},{root:"The Root"},{jezebel:"Jezebel"},{mashable:"Mashable"},{reuters:"Reuters"},{gizmodo:"Gizmodo"},{nytimes:"New York Times"},{seattle:"Seattle Times"},{latimes:"LA Times"},{denver:"Denver Post"},{chicago:"Chicago Times"},{gothamist:"The Gothamist"},{abc:"ABC News"},{guardian:"The Guardian"},{pbs:"PBS"},{npr:"NPR"},{bbc:"BBC"},{slashdot:"Slashdot"},{economist:"The Economist"},{slate:"Slate"},{salon:"Salon"},{techcrunch:"Techcrunch"},{hacker:"Hacker"},{wired:"Wired"},{espn:"ESPN"},{propublica:"ProPublica"},{time:"Time Magazine"},{wallstreet:"The Wall Street Journal"}];for(var s in t)if(t[s].hasOwnProperty(e))return Object.getOwnPropertyDescriptor(t[s],e).value},t=function(e){var t=[{cnn:"http://rss.cnn.com/rss/edition.rss"},{wapo:"http://feeds.washingtonpost.com/rss/national"},{mashable:"http://feeds.mashable.com/Mashable"},{deadspin:"http://deadspin.com/rss"},{root:"http://www.theroot.com/rss"},{jezebel:"http://jezebel.com/rss"},{reuters:"http://feeds.reuters.com/reuters/topNews"},{gizmodo:"https://gizmodo.com/rss"},{slashdot:"http://rss.slashdot.org/Slashdot/slashdotMain"},{gothamist:"http://feeds.gothamistllc.com/gothamist05"},{nytimes:"http://rss.nytimes.com/services/xml/rss/nyt/HomePage.xml"},{seattle:"https://www.seattletimes.com/feed/"},{latimes:"http://www.latimes.com/rss2.0.xml"},{denver:"http://feeds.denverpost.com/dp-news-topstories"},{chicago:"http://www.chicagotribune.com/rss2.0.xml"},{miami:"http://www.miamiherald.com/news/?widgetName=rssfeed&widgetContentId=712015&getXmlFeed=true"},{abc:"http://abcnews.go.com/abcnews/topstories"},{guardian:"https://www.theguardian.com/uk/rss"},{pbs:"http://feeds.feedburner.com/NationPBSNewsHour"},{npr:"http://www.npr.org/rss/rss.php?id=1001"},{bbc:"http://feeds.bbci.co.uk/news/rss.xml"},{nbc:"http://rss.nbcnews.com/"},{economist:"http://www.economist.com/sections/united-states/rss.xml"},{slate:"http://feeds.slate.com/slate"},{techcrunch:"http://feeds.feedburner.com/TechCrunch/"},{hacker:"https://news.ycombinator.com/rss"},{wired:"https://www.wired.com/feed/rss"},{espn:"http://www.espn.com/espn/rss/news"},{propublica:"http://feeds.propublica.org/propublica/main"},{time:"http://feeds2.feedburner.com/time/topstories"},{wallstreet:"http://www.wsj.com/xml/rss/3_7085.xml"}];for(var s in t)if(t[s].hasOwnProperty(e))return Object.getOwnPropertyDescriptor(t[s],e).value},r=function(){i.get("custom_sources",function(e){0!==Object.keys(e).length&&e.custom_sources.forEach(function(e){var t={};t.name=e.name,t.url=e.url,m.push(t)})}),i.get("news_sources",function(s){if(0!==Object.keys(s).length&&s.news_sources.forEach(function(s){var n={};n.name=e(s),n.url=t(s),m.push(n)}),!(m.length>=1)){var n='Please visit the <a target="_blank" href="'+c+'"">Settings</a> panel to select sources';return document.querySelector(".news-list").innerHTML='<p class="no-sources">'+n+"</p>",!1}for(var r="",i=0;i<m.length;i++){document.getElementById("change-source");r+='<option value="'+m[i].url+'">'+m[i].name+"</option>"}h.innerHTML=r,o()})},s=function(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);t["@attributes"][r.nodeName]=r.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var i=e.childNodes.item(o),a=i.nodeName;if(void 0===t[a])t[a]=s(i);else{if(void 0===t[a].push){var c=t[a];t[a]=[],t[a].push(c)}t[a].push(s(i))}}return t},n=function(){window.close()},o=function(){document.querySelector(".news-list").innerHTML='<img class="spinning" src="assets/spin.svg" />';var e=document.getElementById("change-source"),t=e.options[e.selectedIndex].value,s=new XMLHttpRequest;s.open("GET","http://allorigins.us/get?url="+t),s.send(null),s.onreadystatechange=function(){if(4!==s.readyState)return document.querySelector(".news-list").innerHTML='<p class="no-sources">Whoops! Something went wrong with this feed.</p>',!1;if(200!==s.status)return document.querySelector(".news-list").innerHTML='<p class="no-sources">Whoops! Something went wrong with this feed.</p>',!1;for(var e=JSON.parse(s.responseText),t=[],n=(new DOMParser).parseFromString(e.contents,"text/xml").getElementsByTagName("item"),r=0;r<n.length&&!(r>20);r++){var o;o={};for(var i=0;i<n[r].children.length;i++)if("title"==n[r].children[i].nodeName){var a=n[r].children[i].innerHTML.replace("<![CDATA[","").replace("]]>","");o.title=a}else"link"==n[r].children[i].nodeName?o.link=n[r].children[i].innerHTML:"description"==n[r].children[i].nodeName&&(o.description=n[r].children[i].innerHTML);t.push(o)}var c="<ul>";if(t.length<1)return document.querySelector(".news-list").innerHTML='<p class="no-sources">Whoops! Something went wrong with this feed.</p>',!1;t.forEach(function(e){c+='<li><a target="_blank" href="'+e.link+'">'+e.title+"</a></li>"}),c+="</ul>",document.querySelector(".news-list").innerHTML=c}},l.addEventListener("click",n),h.addEventListener("change",o),document.addEventListener("DOMContentLoaded",r)}();